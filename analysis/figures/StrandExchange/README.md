========================
StrandExchange
========================

**DATA**

This analysis begins with raw, unsorted BAM files for a strand-mixture control generated by mixing equal volumes RNA extract from patients A and C at timepoint 0, then preparing two replicates libraries for sequencing according to the same protocols as used for the other samples. There is also an input file "MIX1A-4-HA-sites.data" that lists the nucleotide sites of interest, which were determined to be fixed differences between the two samples along a 200 bp region of the HA gene. Numbering was given along the HA gene. The file also lists the identity at each of these sites for patients A and C.

**ANALYSIS**

*haplotype calling* The script "bin/CountHaplotypes-2.0" takes in an unsorted BAM file, a chromosome name, and an ordered list of one-indexed sites of interest on that chromosome. Note that these sites are by base position, not amino acid position. The script identifies paired-end reads that span the sites of interest and records the bases in each read at the sites of interest. If the read does not cover a site or the coverage is too low, then the script records 'N.' It outputs a .haplotype file with one haplotype per line, with tabs separating the bases recorded at each site. I then use basic bash tools to concatenate these base records into multi-base haplotypes (i.e. "AGTA") and to count how many were observed in each sequenced sample. This information is record in a .hapsummary file. The script Run.sh submits jobs to call haplotypes in the two replicate libraries and concatenates the haplotype summaries calculated from each sample. It requires a file like one specified above listing the sites of interest.

*haplotype frequencies and plotting* The R script CalculateFrequencies.R takes in a concatenated .hapsummary file listing the counts of each haplotype in each replicate. It removes incomplete haplotypes and converts nucleotide haplotypes like "AGTA" to character haplotypes like 0120 using the information about ancestral and derived alleles above. It excludes all haplotypes that include a third allele, none of which are represented at high frequency in the overall population. It iterates along the length of each haplotypes to determine whether recombination has occurred relative to the first base and calculates this cumulative recombination frequency as it moves along the haplotype.


**OPEN ISSUES**

None currently recorded.